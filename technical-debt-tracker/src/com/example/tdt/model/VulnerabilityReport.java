package com.example.tdt.model;

import java.util.ArrayList;
import java.util.List;

public class VulnerabilityReport {
    private String projectId;
    private List<String> vulnerableDeps = new ArrayList<>();
    private List<String> suggestions = new ArrayList<>();

    public VulnerabilityReport(String projectId) {
        this.projectId = projectId;
    }

    public void addVulnerableDependency(Dependency dep, String recommendedVersion) {
        vulnerableDeps.add(dep.toString());
        suggestions.add("Update " + dep.toString() + " to " + recommendedVersion);
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("Vulnerability report for project: ").append(projectId).append("\n");
        sb.append("  Vulnerable dependencies:\n");
        for (String dep : vulnerableDeps) sb.append("    - ").append(dep).append("\n");
        sb.append("  Suggestions:\n");
        for (String s : suggestions) sb.append("    - ").append(s).append("\n");
        return sb.toString();
    }
}
